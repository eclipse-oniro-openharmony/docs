# 知识检索召回

## 场景介绍
知识检索召回是RAG知识库、知识图谱等数据智慧化场景的数据查询基础，可将存储在多路数据库中的数据信息（如倒排索引存储的原文本、向量索引存储的语义向量、图索引存储的知识关系）等信息，通过简单的查询语句完成知识的召回、融合和精排。

## 运作机制
知识检索召回主要包括多路数据融合召回和深度融合重排两部分。

### 多路数据融合召回
多路数据召回主要包括文本召回、向量召回、图检索等技术。
从信息检索发展初期到现在，文本检索一直是信息召回的主力方式。它具有很好的解释性，同时对于不同数据场景鲁棒性恒强。
Arkdata基于SQLite FTS来实现文本召回功能，SQLite FTS（Full-Text-Search）是一种高效的全文搜索技术，是基于倒排索引实现，用于在大量文本数据中快速找到包含特定词汇的记录。
向量召回用于召回语义相关的候选文档，以弥补文本召回召回基于字面匹配、泛化困难的不足，同时也能应用于图像等多模数据的召回。向量召回依赖表征模型和向量检索引擎，ArkData使用多模态表征模型和向量数据库来实现向量召回功能。

### 深度融合重排
重排算法包括倒数排名融合和深交互排序模型等方案。
倒数排名融合（RRF）是一种经典的重排算法，广泛应用于工业界。可评估多个以前的排名结果中的搜索分数以生成统一的结果集。
RRF基于倒数排名的概念，即搜索结果列表中第一个相关文档的排名的倒数。
该方法的目标是考虑项目在原始排名中的位置，并赋予在多个列表中排名较高的项目更高的重要性。这有助于提高最终排名的整体质量和可靠性。使其对融合多个有序搜索结果的任务更加有用。
深交互排序模型通用性好、泛化性好、高精度、支撑长文本排序，主要基于开源通用IR数据集进行训练，具备良好的通用性于泛化性，可直接在业务落地场景进行zero-shot部署，同时也支持基于LLM生成垂域微调数据，进行领域迁移和与适配，进一步增加其相关性排序效果。

## 开发准备

### 规格
- 支持多路数据库内容召回，目前支持向量数据库和倒排数据库。
- 支持召回结果重排，目前支持倒排排名融合算法。

### 约束限制
- 支持PC产品。

## 接口说明
本场景指导涉及到的多路融合查询的接口说明和呈现，同步链接到具体API参考页面。

## 开发流程
1. 业务明确需要召回的数据所存储的引擎；
2. 根据查询需求，按照配置进行多路融合查询的语句准备；
3. 获取融合查询结果。

## 开发步骤关键点
- 引用ohos.data.intelligence.d.ts、ohos.data.relationalStore.d.ts
- 描述多路召回配置参数以及接口调用后的返回数据结构。
- 关键配置：检查关键配置是否已经具备
