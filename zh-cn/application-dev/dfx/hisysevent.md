# hisysevent


hisysevent是系统的预置工具，主要用来帮助开发者订阅实时系统事件，查询历史系统事件。开发者通过[hdc工具](hdc.md)进入设备之后，在终端通过执行“hisysevent”命令完成相关能力的调用。


### 订阅实时系统事件

**开发者通过“hisysevent -r”命令完成对系统事件的订阅。**

![zh-cn_image_0000001704619280](figures/zh-cn_image_0000001704619280.png)

**开发者可通过“-g”指定事件类型来完成对系统事件更高精确度的订阅。**

样例：订阅**FAULT**（错误）类型的系统事件。

![zh-cn_image_0000001704621796](figures/zh-cn_image_0000001704621796.png)

> **说明：**
> hisysevent命令行工具通过“-g”只能指定**FAULT**（错误类型）、**STATISTIC**（统计类型）、**SECURITY**（安全类型）以及**BEHAVIOR**（用户行为类型）四种事件类型。如果开发者没有通过“-g”指定事件类型，hisysevent命令行工具将订阅所有类型的系统事件。

**开发者可以通过“-o”指定事件域，“-n”指定事件名，以及“-c”指定事件域和事件名称的匹配规则，完成系统事件更高精确度的订阅。**

样例1：使用全词匹配规则，订阅事件域为“DISPLAY”，事件名称为“AMIENT_LIGHT”的系统事件。

![zh-cn_image_0000001704753742](figures/zh-cn_image_0000001704753742.png)样例2：使用前缀匹配规则，订阅事件域前缀为“DIS”，事件名称前缀为“AMBIENT”的系统事件。

![zh-cn_image_0000001704594490](figures/zh-cn_image_0000001704594490.png)样例3：使用正则表达式匹配规则，订阅事件域可以匹配“DIS\*”正则表达式，事件名称可以匹配“AMBIENT\*”正则表达式的系统事件。![zh-cn_image_0000001704754126](figures/zh-cn_image_0000001704754126.png)

**开发者可通过“-t”指定事件标签以及“-c”指定事件标签的匹配规则，来完成系统事件更高精确度的订阅。**

样例1：使用全词匹配规则，订阅事件标签为“PowerStats”的系统事件。

![zh-cn_image_0000001704761754](figures/zh-cn_image_0000001704761754.png)样例2：使用前缀匹配规则，订阅事件标签前缀为“PowerS”的系统事件。

![zh-cn_image_0000001752442037](figures/zh-cn_image_0000001752442037.png)样例3：使用正则表达式匹配规则，订阅事件标签可以匹配“PowerS\*”正则表达式的系统事件。

![zh-cn_image_0000001752482085](figures/zh-cn_image_0000001752482085.png)

> **说明：**
> hisysevent命令行工具通过“-c”只能指定**WHOLE_WORD**(全词匹配)、**PREFIX**（前缀匹配）以及**REGULAR**（正则匹配）三种匹配规则，如果开发者没有通过“-c”指定匹配规则，hisysevent命令行工具将默认使用**WHOLE_WORD**匹配规则进行订阅匹配。


### 查询历史事件

**开发者通过“hisysevent -l”命令完成对已落盘的系统事件的查询。**

![zh-cn_image_0000001752583081](figures/zh-cn_image_0000001752583081.png)**开发者可以通过“-g”指定事件类型来完成对系统事件更高精确度的查询。**

样例：查询**SECURITY**（安全）类型的系统事件。

![zh-cn_image_0000001752503213](figures/zh-cn_image_0000001752503213.png)

> **说明：**
> hisysevent命令行工具通过“-g”只能指定**FAULT**（错误类型）、**STATISTIC**（统计类型）、**SECURITY**（安全类型）以及**BEHAVIOR**（用户行为类型）四种事件类型，如果开发者没有通过“-g”指定事件类型，hisysevent命令行工具将查询所有类型的系统事件。



**开发者可以通过“-s”指定起始原始时间戳、“-e”指定截止原始时间戳，完成对特定时间段内系统事件的查询。**


样例：查询起始时间戳是1699595955630，结束时间戳是1699595955648时间段内的所有系统事件。


![zh-cn_image_0000001752596737](figures/zh-cn_image_0000001752596737.png)


> **说明：**
> 原始时间戳精确度为毫秒。


**开发者可以通过“-S”指定起始格式化时间戳、“-E”指定截止格式化时间戳，完成对特定时间段内系统事件的查询。**


样例：查询起始时间戳是“2023-11-10 14:07:01”，结束时间戳是“2023-11-10 14:07:03”时间段内的所有系统事件。


![zh-cn_image_0000001704801664](figures/zh-cn_image_0000001704801664.png)


> **说明：**
> 格式化时间戳的格式为：“YYYY-MM-DD hh:mm:ss”。


**和订阅实时系统事件类似，开发者可以通过“-o”指定事件域，“-n”指定事件名，以及“-c”指定事件域和事件名称的匹配规则，来完成系统事件更高精度的查询。**


样例1：使用全词匹配规则，查询事件域为“KERNEL_VENDOR”，事件名称为“POWER_KEY”的系统事件。


![zh-cn_image_0000001704809272](figures/zh-cn_image_0000001704809272.png)


> **注意：**
> hisysevent命令行工具通过“-c”只能指定**WHOLE_WORD**（全词匹配）一种匹配规则。当然，如果开发者不通过“-c”指定匹配规则，hisysevent命令行工具仍使用**WHOLE_WORD**（全词匹配）匹配规则进行查询匹配。


**开发者可通过“-m”指定查询的最大系统事件条数。**


![zh-cn_image_0000001704656586](figures/zh-cn_image_0000001704656586.png)![zh-cn_image_0000001704818394](figures/zh-cn_image_0000001704818394.png)


> **说明：**
> 如果开发者不通过“-m”指定查询的最大系统事件条数，hisysevent命令行工具将默认最多只查询10000条系统事件。


### 合法性检查模式

**开发者可以通过“-v”打开合法性检查模式。在合法性检查模式开启后，任何订阅或者查询到的系统事件如包含非法内容都会红色高亮显示。**

样例：事件域为“AAFWK”，事件名称为“APP_LAUNCH”的[系统事件配置](https://gitee.com/openharmony/docs/blob/master/zh-cn/device-dev/subsystems/subsys-dfx-hisysevent-logging-config.md)中不包含“CALLER_BUNDLE_NAME”自定义参数，但是实际落盘的系统事件却包含此字符串类型的键值对，合法性检查模式开启的情况下，此键值对的键被红色高亮标注。

![zh-cn_image_0000001752623073](figures/zh-cn_image_0000001752623073.png)

> **说明：**
> 对“非法内容”的定义标准：
> 
> 1. 未配置的自定义参数键。
> 
> 2. 类型和定义的类型不匹配的值。
